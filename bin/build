#!/usr/bin/env node

'use strict';

const asciidoctor = require('asciidoctor.js')();
const {join,extname} = require('path');

const [,,...files] = process.argv;
const BUILD_DIR = join(__dirname, '..', 'dist');

const DEFAULT_ATTRIBUTES = [
  'lang=fr',
  'hide-uri-scheme',
  'toclevels=4',
];

files.forEach(SOURCE_FILE => {
  const ext = extname(SOURCE_FILE);
  const destinationFile = SOURCE_FILE.replace(ext, '.html');

  asciidoctor.convertFile(join(__dirname, '..', SOURCE_FILE), {
    attributes: DEFAULT_ATTRIBUTES,
    backend: 'html5',
    mkdirs: true,
    safe: 'unsafe',
    to_file: `${BUILD_DIR}/${destinationFile}`,
  });
});
